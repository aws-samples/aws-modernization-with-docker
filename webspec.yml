version: 0.2

phases:
  pre_build:
    commands:
      - echo Logging in to Docker Hub...
      # Type the command to log in to your Docker Hub account here.  
      - docker login 
      - DOCKER_HUB_ID=${DOCKER_HUB_ID}
      - DOCKER_PULL_SECRETS_MANAGER=${DOCKER_PULL_SECRETS_MANAGER}
  build:
    commands:
      - docker compose -f docker-compose.yaml
      - docker-compose.prod.migrate.yaml up
  post_build:
    commands:
      - echo Build completed on `date`
      - echo Pushing the Docker image...
      - docker push $IMAGE_REPO_NAME:$IMAGE_TAG
      
